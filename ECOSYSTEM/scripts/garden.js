function K(i,t={BASE_SIZE:.02,BLOB_COUNT:12,AMPLITUDE:.86,JITTER_SPEED:35.5,HUE_RANGE:[200,360],HUE_SHIFT:30,HUE_SHIFT_RANGE:80,BG_ALPHA_RANGE:[.01,.1],SPRING_K:2}){let n=i.getContext("2d");n.globalCompositeOperation="color-burn";let e,r,a=0,c=0,l=0,u=0,y=4,x=2,M=500,k=300,{BASE_SIZE:tt=t.BASE_SIZE||.02,SIZE_RANDOM:et=.1,BLOB_COUNT:F=t.BLOB_COUNT||12,POINTS:G=50,AMPLITUDE:nt=.86,JITTER_SPEED:ot=t.JITTER_SPEED||35.5,SPRING_K:it=t.SPRING_K||2,G:rt=2e3,DAMPING:j=.98,CANVAS_FILTER:st="saturate(3.1) contrast(1.4) brightness(0.9)",HUE_RANGE:P=t.HUE_RANGE||[200,360],HUE_SHIFT:at=t.HUE_SHIFT||30,HUE_SHIFT_RANGE:ct=t.HUE_SHIFT_RANGE||80,SATURATION:lt=50,SATURATION2:ht=50,LIGHTNESS:ft=65,LIGHTNESS2:dt=60,ALPHA:ut=.5,ALPHA2:mt=.5,COLOR_STOP:At=1,RESIZE_RADIUS:St=.06,BG_ALPHA_RANGE:O=t.BG_ALPHA_RANGE||[.01,.1]}=window.currentChannelConfig||{};function W(){e=i.width=innerWidth,r=i.height=innerHeight}window.addEventListener("resize",W),W(),document.body.addEventListener("click",S=>{l=S.clientX,u=S.clientY,c=performance.now()});let I=[],T=Math.random;i.style.filter=st;class gt{constructor(f,g,s,m){this.x=f,this.y=g,this.vx=(T()-.5)*80,this.vy=(T()-.5)*80,this.baseRadius=s,this.hue=m,this.offsets=new Float32Array(G)}update(f){for(let o=0;o<G;o++)this.offsets[o]+=(T()*2-1)*ot*this.baseRadius*nt*f,this.offsets[o]-=this.offsets[o]*it*f;let g=this.offsets.slice();for(let o=0;o<G;o++){let h=g[(o-1+G)%G],d=g[(o+1)%G];this.offsets[o]=this.offsets[o]*.3+(h+d)*.002}let s=0,m=0;for(let o of I){if(o===this)continue;let h=o.x-this.x,d=o.y-this.y,E=h*h+d*d+100,R=rt/E;s+=R*h,m+=R*d}if(c>0){let o=(a-c)/1e3;if(o<y){let h=l-this.x,d=u-this.y,E=Math.hypot(h,d)||1;s+=M*h/E,m+=M*d/E}else if(o<y+x){let h=e/2-this.x,d=r/2-this.y,E=Math.hypot(h,d)||1;s+=k*h/E,m+=k*d/E}else c=0}this.vx=(this.vx+s*f)*j,this.vy=(this.vy+m*f)*j,this.x+=this.vx*f,this.y+=this.vy*f,this.x<0?this.x+=e:this.x>e&&(this.x-=e),this.y<0?this.y+=r:this.y>r&&(this.y-=r)}draw(){let f=n.createRadialGradient(this.x,this.y,this.baseRadius*St,this.x,this.y,this.baseRadius),g=(this.hue+at)%ct;f.addColorStop(0,`hsla(${g},${lt}%,${ft}%,${ut})`),f.addColorStop(At,`hsla(${this.hue},${ht}%,${dt}%,${mt})`),n.fillStyle=f,n.beginPath();for(let s=0;s<G;s++){let m=s/G*Math.PI*2,o=this.baseRadius+this.offsets[s],h=this.x+Math.cos(m)*o,d=this.y+Math.sin(m)*o;s===0?n.moveTo(h,d):n.lineTo(h,d)}n.closePath(),n.fill()}}for(let S=0;S<F;S++){let f=S/F*Math.PI*2,g=e/2+Math.cos(f)*(Math.min(e,r)*.2),s=r/2+Math.sin(f)*(Math.min(e,r)*.2),m=Math.min(e,r)*tt+et*T(),o=P[0]+(P[1]-P[0])*T();I.push(new gt(g,s,m,o))}let X=performance.now(),U=window.currentChannelImage;U&&(U.onload=()=>{let S=n.createPattern(U,"repeat");n.save(),n.fillStyle=S,n.fillRect(0,0,t.WIDTH||e/3,t.HEIGHT||r/3),n.restore()});function Z(S){let f=(S-X)/1e3;X=S,a=S,n.save();let g=T()*(O[1]-O[0])+O[0];if(n.globalAlpha=g,window.currentChannelImage){let s=n.createPattern(window.currentChannelImage,"repeat");n.fillStyle=s,n.fillRect(0,0,e,r)}n.restore(),I.forEach(s=>s.update(f));for(let s=0;s<I.length;s++)for(let m=s+1;m<I.length;m++){let o=I[s],h=I[m],d=h.x-o.x,E=h.y-o.y,R=Math.hypot(d,E)||.001,q=o.baseRadius+h.baseRadius;if(R<q){let w=q-R,v=d/R,H=E/R,N=(.5+T())*150;o.x-=v*w*.2,o.y-=H*w*.2,h.x+=v*w*.2,h.y+=H*w*.2,o.vx-=v*N,o.vy-=H*N,h.vx+=v*N,h.vy+=H*N}}I.forEach(s=>s.draw()),requestAnimationFrame(Z)}requestAnimationFrame(Z)}var A={garden:{seedling:"\u{1F331}",leaf:"\u{1F343}",jar:"\u{1FAD9}",ant:"\u{1F41C}",eagle:"\u{1F985}",feather:"\u{1FAB6}",owl:"\u{1F989}"},river:{water:"\u{1F4A7}",gold:"\u{1F4B0}",wood:"\u{1FAB5}",stone:"\u{1FAA8}",reed:"\u{1F33F}",fish:"\u{1F41F}",sponge:"\u{1F9FD}"},mountain:{water:"\u{1F4A7}",mushroom:"\u{1F344}",wood:"\u{1FAB5}",stone:"\u{1FAA8}",ice:"\u{1F9CA}",gem:"\u{1F48E}",tool:"\u{1FA93}"}},_={garden:["seedling","leaf","jar","ant","eagle","feather","owl"],river:["water","gold","wood","stone","reed","fish","sponge"],mountain:["water","mushroom","wood","stone","ice","gem","tool"]},Et=[{inputs:["SAG-001","leaf","gem"]},{inputs:["SAG-235","SAG-041","SAG-466"]},{inputs:["water","SAG-125","tool"]}],p={garden:Object.fromEntries(_.garden.map((i,t)=>[i,t])),river:Object.fromEntries(_.river.map((i,t)=>[i,t])),mountain:Object.fromEntries(_.mountain.map((i,t)=>[i,t]))};function z(i,t,n,e="SAG-"){let r=p.garden[t],a=p.river[i],c=p.mountain[n];return[a,r,c].some(l=>l==null)?null:`${e}${a}${r}${c}`}var J=i=>/^SAG-[0-6]{3}$/.test(String(i));function b(i){let t=/^SAG-(\d)(\d)(\d)$/.exec(String(i));return t?{r:+t[1],g:+t[2],m:+t[3]}:null}function pt(i){let t=i.slice(0,3);if(t.every(J)){let a=b(t[0]),c=b(t[1]),l=b(t[2]);return`SAG-${a.r}${c.g}${l.m}`}let n=null,e=null,r=null;for(let a of t){if(J(a)){let c=b(a);n==null&&(n=c.r),e==null&&(e=c.g),r==null&&(r=c.m);continue}a in p.river&&(n=p.river[a]),a in p.garden&&(e=p.garden[a]),a in p.mountain&&(r=p.mountain[a])}return n==null||e==null||r==null?null:`SAG-${n}${e}${r}`}var C=[{garden:"seedling",river:"water",mountain:"mushroom"},{garden:"leaf",river:"wood",mountain:"gem"},{garden:"jar",river:"sponge",mountain:"tool"}];function Y(i=C,t=[]){return[...i.map(e=>[e.river,e.garden,e.mountain]),...t.map(e=>e.inputs)].filter(Boolean).map(e=>{let r=pt(e),a=`unlock:${r}`,c=Object.create(null);for(let l of e)c[l]=(c[l]||0)+1;return{id:`code-${e.join("-")}`,label:r,icon:"\u{1F50F}",description:e.map(l=>A.river[l]||A.garden[l]||A.mountain[l]||"\u{1F50F}").join(" + ")+` \u2192 ${r}`,requires:c,gives:{[r]:1},flag:a}})}var $=Y(C,Et);function B({crafts:i=C,previewSelector:t="#status"}={}){let n=new Set;function e(){let r=window.SAG&&window.SAG.get&&window.SAG.get()||{},a=r.inv||{},c=new Set(r.flags||{}),l=!1;for(let u of i){let y=z(u.river,u.garden,u.mountain),x=u.flag||`unlock:${y}`;if(c.has(x)||n.has(x))continue;if((a[u.river]|0)>0&&(a[u.garden]|0)>0&&(a[u.mountain]|0)>0){l=!1;break}}if(l){el.textContent="";return}}setInterval(e,800),e()}function Gt(){let i=[];for(let t of _.river)for(let n of _.garden)for(let e of _.mountain)i.push({river:t,garden:n,mountain:e});return i}var L=i=>Object.keys(i),Tt=L(A.river),Rt=L(A.garden),_t=L(A.mountain);var yt={...A.river,...A.garden,...A.mountain};typeof window<"u"&&(window.SAGCodes={ICONS:A,ALPHABET:_,genCode:z,CRAFTS:C,buildRecipes:Y,RECIPES:$,startAutoUnlocker:B,allCombos:Gt});var D,V=document,Q=window;(async()=>{D=V.getElementById("shade");let i=new Image;i.src="images/flora.png",await i.decode(),window.currentChannelImage=i,V.body.appendChild(D),K(D,{BASE_SIZE:.009,BLOB_COUNT:32,AMPLITUDE:.66,JITTER_SPEED:15.5,HUE_RANGE:[150,400],HUE_SHIFT:20,HUE_SHIFT_RANGE:10,BG_ALPHA_RANGE:[.006,.01],SPRING_K:12,WIDTH:Q.innerWidth*.001*Math.random(),HEIGHT:Q.innerHeight*.002*Math.random()});let t=A.garden,n={...A.garden,...A.river,...A.mountain};SAGGame.init(),SAGGame.inventory.init({title:"Garden Inventory",recipes:SAGCraft.recipes().concat($),icons:t,craftIcons:n}),B();let e=Object.keys(t),r=Object.fromEntries(e.map(l=>[l,SAGGame.morseForWord(l)])),a=SAGGame.morseItemClaimer(r,{once:!1}),c=SAGGame.morse({el:"#shade",out:"#out",status:"#status",clear:"#clear",unit:240,tolerance:.55,letterGapMul:2.2,wordGapMul:5.5,autoWordMs:500,symbolSpacing:"thin",onWord(l){let u=SAGGame.claimSAG(l);if(u==="hit"||u==="duplicate"){c.reset();return}u=a(l),(u==="hit"||u==="duplicate")&&c.reset()}})})();
